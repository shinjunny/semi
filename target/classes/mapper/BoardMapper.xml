<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org/DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dish.board.mapper.BoardMapper">

    <select id="findAll" resultType="com.dish.board.vo.BoardVO">
        SELECT * FROM BOARD ORDER BY BOARD_NUM DESC
    </select>
    
    <select id="selectBoardsByType" resultType="com.dish.board.vo.BoardVO">
        SELECT * FROM board
        WHERE board_type = #{boardType}
        ORDER BY BOARD_NUM DESC
    </select>

    <select id="findById" parameterType="long" resultType="com.dish.board.vo.BoardVO">
        SELECT * FROM BOARD WHERE BOARD_NUM = #{boardNum}
    </select>

    <insert id="insert" parameterType="com.dish.board.vo.BoardVO">
        INSERT INTO BOARD (
            BOARD_TYPE, BOARD_TITLE, BOARD_COMMENT,
            CREATOR, CREATE_TIME, MODIFIER, MODIFIED_TIME
        ) VALUES (
            #{boardType}, #{boardTitle}, #{boardComment},
            #{creator}, SYSDATE, #{modifier}, SYSDATE
        )
    </insert>

    <update id="update" parameterType="com.dish.board.vo.BoardVO">
        UPDATE BOARD
        SET
            BOARD_TYPE = #{boardType},
            BOARD_TITLE = #{boardTitle},
            BOARD_COMMENT = #{boardComment},
            MODIFIER = #{modifier},
            MODIFIED_TIME = SYSDATE
        WHERE BOARD_NUM = #{boardNum}
    </update>

    <delete id="delete" parameterType="long">
        DELETE FROM BOARD WHERE BOARD_NUM = #{boardNum}
    </delete>
    
    <select id="searchBoardsByTitle" resultType="BoardVO">
        SELECT * FROM board
        WHERE board_type = #{boardType}
        AND board_title LIKE '%' || #{title} || '%'
    </select>
    
    <select id="selectBoardsByUserId" parameterType="String" resultType="com.dish.board.vo.BoardVO">
        SELECT 
		    B.BOARD_TYPE,
		    B.BOARD_NUM,
		    B.BOARD_TITLE,
		    B.BOARD_COMMENT,
		    B.CREATOR,
		    B.CREATE_TIME
		FROM 
		    BOARD B
		JOIN 
		    USER_INFO M ON B.CREATOR = M.USER_ID
		WHERE 
		    M.USER_ID = #{userId}
		ORDER BY 
		    B.CREATE_TIME DESC

    </select>
    
</mapper>